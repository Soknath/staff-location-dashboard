(this["webpackJsonpstaff-location-dashboard"]=this["webpackJsonpstaff-location-dashboard"]||[]).push([[0],{377:function(e,t,a){e.exports=a(478)},382:function(e,t,a){},477:function(e,t,a){},478:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(16),o=a.n(r),c=(a(382),a(43)),i=a(265),s=a(86),u=a(370),m=(a(384),Object(n.createContext)({data:null,getData:function(){},selectId:null,getSelectedID:function(){}}));function d(){var e=Object(n.useContext)(m);return{data:e.data,getData:e.getData}}function p(){var e=Object(n.useContext)(m);return{selectedID:e.selectedID,getSelectedID:e.getSelectedID}}var f=a(58),g=a(500),h=a(506),E=a(59),v="https://backend.powermap.live",b="".concat(v,"/company-departments?_limit=-1"),x=Object(f.a)((function(e){return{root:{flexGrow:1}}}));function y(e){var t=x();return l.a.createElement(g.a,{container:!0,alignItems:"flex-start",className:t.root,spacing:2},l.a.createElement(g.a,{item:!0,xs:3,style:{margin:"auto"}},l.a.createElement(h.a,{src:v+e.info.avatar.url,alt:"props.info.firstName"})),l.a.createElement(g.a,{item:!0,xs:9},l.a.createElement(E.a,{component:"subtitle1",variant:"subtitle1"},e.info.firstName+" "+e.info.lastName,l.a.createElement("br",null),l.a.createElement("small",null,new Date(e.info.createdAt).toLocaleString()))),l.a.createElement(g.a,{item:!0,xs:12},l.a.createElement(E.a,{component:"p",variant:"p"},e.info.address)))}var w={width:"20px",height:"20px",color:"#fff",background:"#1978c8",borderRadius:"20px",textAlign:"center"},S=function(e){var t=e.longitude,a=e.latitude,n=e.pointCount;return l.a.createElement(s.d,{longitude:t,latitude:a},l.a.createElement("div",{style:Object(i.a)({},w,{background:"#f28a25"})},n))};function O(){var e=l.a.useState({longitude:100.594699,latitude:14.244686,bearing:0,zoom:15}),t=Object(c.a)(e,2),a=t[0],r=t[1],o=l.a.useState(null),m=Object(c.a)(o,2),f=m[0],g=m[1],h=d().data,E=p(),v=E.selectedID,b=E.getSelectedID;Object(n.useEffect)((function(){v&&v.latitude&&(r(Object(i.a)({},a,{latitude:v.latitude,longitude:v.longitude,zoom:18})),g(v),b(null))}));return h?l.a.createElement(s.g,Object.assign({style:{width:"100%",height:"400px"},mapStyle:"https://search.map.powermap.in.th/api/v2/map/vtile/styles?name=thailand_th_black&access_token=b378c575291af30a29f59919fd7e7e4c012d45c4"},a,{onViewportChange:function(e){r(e)},dragPan:!0,viewportChangeMethod:"flyTo",viewportChangeOptions:1200}),f&&l.a.createElement(s.f,{tipSize:5,anchor:"bottom",longitude:f.longitude,latitude:f.latitude,closeOnClick:!0,onClose:function(){return g(null)},style:{width:"300px !important"}},l.a.createElement(y,{info:f})),l.a.createElement(u.a,{radius:40,extent:512,nodeSize:64,component:S},h.map((function(e){return l.a.createElement(s.d,{key:e.id,longitude:e.longitude,latitude:e.latitude},l.a.createElement("svg",{height:20,viewBox:"0 0 24 24",style:{cursor:"pointer",fill:"#d00",stroke:"none",transform:"translate(0px,".concat(20,"px)")},onClick:function(){return t=e,console.log(t),void g(t);var t}},l.a.createElement("path",{d:"M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3\n  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9\n  C20.1,15.8,20.2,15.8,20.2,15.7z"})))}))),l.a.createElement(s.e,{showCompass:!0,showZoom:!0,position:"top-right"}),l.a.createElement(s.a,{position:"top-right"}),l.a.createElement(s.b,{position:"top-right"})):null}var D=a(113),j=a.n(D),k=a(224),C=a(362),A=a.n(C),I=a(155),N=a(260),_=a(261),z=a(264),L=a(326),B=a(111),Y=a(359),M=a(112),P=a.n(M),F=a(369),G=a(22),R=a(252);function T(e){var t=l.a.useState(new P.a),a=Object(c.a)(t,2),r=a[0],o=a[1],i=l.a.useState(new P.a),s=Object(c.a)(i,2),u=s[0],m=s[1],f=l.a.useState(null),E=Object(c.a)(f,2),x=E[0],y=E[1],w=l.a.useState(),S=Object(c.a)(w,2),O=S[0],D=S[1],C=l.a.useState(),M=Object(c.a)(C,2),T=M[0],W=M[1],V=l.a.useState(null),J=Object(c.a)(V,2),K=J[0],H=J[1],U=l.a.useState(null),Z=Object(c.a)(U,2),$=Z[0],q=Z[1],Q=d().getData,X=p().getSelectedID;Object(n.useEffect)((function(){function e(){return(e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(v+"/staff-locations?_limit=-1&_sort=createdAt:DESC&createdAt_gte=".concat((new P.a).startOf("day").toISOString())).then((function(e){return e.json()}));case 3:t=e.sent,console.log(t),y(t),Q(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function t(){return(t=Object(k.a)(j.a.mark((function e(){var t,a,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(b).then((function(e){return e.json()}));case 3:return t=e.sent,a=[],n={},e.next=8,t.map((function(e,t){a.includes(e.companyName)||a.push(e.companyName),Object.keys(n).includes(e.companyName)?(console.log(e.companyName),n[e.companyName].push(e.department),console.log(n)):(console.log(e.companyName),n[e.companyName]=[e.department])}));case 8:H(a),q(n),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}x||function(){e.apply(this,arguments)}(),K&&$||(console.log(),function(){t.apply(this,arguments)}())}),[]);var ee=function(){var e=Object(k.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(v,"/staff-locations?_limit=-1&_sort=createdAt:DESC&createdAt_gte=").concat(new P.a(r).toISOString(),"&createdAt_lte=").concat(new Date(u).toISOString(),"&").concat(O?"company="+O:"","&").concat(T?"department="+T:"")).then((function(e){return e.json()}));case 3:t=e.sent,console.log(t),y(t),Q(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();function te(e,t){var a=document.createElement("a"),n=function(e,t){var a,n=[];return e.forEach((function(e){"url"!==e.field&&n.push(e.field)})),a="",a+=n.join(","),a+="\n",t.forEach((function(e){var t=0;n.forEach((function(n){t>0&&(a+=","),a+="createdAt"===n?new Date(e[n]).toLocaleString():e[n],t++})),a+="\n"})),console.log(a),a}(e,t);if(null!=n){var l="export_from_".concat(new Date(r).toLocaleDateString(),"_to_").concat(new Date(u).toLocaleDateString(),".csv");n.match(/^data:text\/csv/i)||(n="data:text/csv;charset=utf-8,".concat(n)),a.setAttribute("href",encodeURI(n)),a.setAttribute("download",l),a.click()}}return x&&K&&$?l.a.createElement(G.a,{utils:F.a},l.a.createElement(l.a.Fragment,null,l.a.createElement(I.a,null,l.a.createElement("div",{style:{backgroundColor:"#e8eaf5"}},l.a.createElement(g.a,{container:!0,spacing:3,style:{marginLeft:15},justify:"center",alignItems:"center"},l.a.createElement(g.a,{item:!0,xs:2},l.a.createElement(R.b,{margin:"normal",id:"date-picker-dialog",label:"start date",format:"YYYY/MM/DD",value:r,onChange:function(e){o(e)},KeyboardButtonProps:{"aria-label":"change date"},inputVariant:"outlined",size:"small"})),l.a.createElement(g.a,{item:!0,xs:2},l.a.createElement(R.b,{margin:"normal",id:"date-picker-dialog",label:"end date",format:"YYYY/MM/DD",value:u,onChange:function(e){m(e)},KeyboardButtonProps:{"aria-label":"change date"},inputVariant:"outlined",size:"small"})),l.a.createElement(g.a,{item:!0,xs:2},l.a.createElement(N.a,{variant:"outlined",fullWidth:!0,size:"small"},l.a.createElement(_.a,{id:"demo-simple-select-outlined-label"},"Company"),l.a.createElement(z.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:O,onChange:function(e){D(e.target.value),W(null)},label:"Company"},K.map((function(e,t){return l.a.createElement(L.a,{value:e,key:t},e)}))))),l.a.createElement(g.a,{item:!0,xs:2},l.a.createElement(N.a,{variant:"outlined",fullWidth:!0,size:"small"},l.a.createElement(_.a,{id:"demo-simple-select-outlined-label"},"Department"),l.a.createElement(z.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:T,onChange:function(e){W(e.target.value)},label:"Department"},O?$[O].map((function(e,t){return l.a.createElement(L.a,{value:e,key:t},e)})):null))),l.a.createElement(B.a,{variant:"contained",color:"primary",size:"large",onClick:function(){return ee()}},"SEARCH")))),l.a.createElement(A.a,{onRowClick:function(e,t){console.log(t),X(t)},title:"Total Found: ".concat(x.length," person"),columns:[{title:"Company",field:"company"},{title:"Department",field:"department"},{field:"url",title:"Avatar",width:30,export:!1,render:function(e){return l.a.createElement(h.a,{alt:"selfie",src:v+e.avatar.formats.small.url,style:{width:30,height:30}})}},{title:"Emp. ID",field:"empID"},{title:"First name",field:"firstName"},{title:"Last name",field:"lastName"},{title:"Gender",field:"gender",hidden:!0,export:!0},{title:"Email",field:"email",hidden:!0,export:!0},{title:"Address",field:"address",hidden:!0,export:!0},{title:"Checkin At",field:"createdAt",render:function(e){return new Date(e.createdAt).toLocaleString()}}],detailPanel:function(e){return l.a.createElement(g.a,{container:!0,spacing:2,style:{margin:10}},l.a.createElement(g.a,{item:!0},l.a.createElement(Y.a,{label:e.gender})),l.a.createElement(g.a,{item:!0},l.a.createElement(Y.a,{label:e.email})),l.a.createElement(g.a,{item:!0},l.a.createElement(Y.a,{label:e.address})))},options:{search:!0,exportButton:!0,paging:!0,pageSize:20,grouping:!0,exportAllData:!0,exportCsv:function(e,t){te(e,t)},pageSizeOptions:[5,10,20,50],cellStyle:{height:40,paddingTop:0,paddingBottom:0,textAlign:"right"},headerStyle:{textAlign:"right"}},data:x}))):null}var W=a(153),V=a(504),J=a(259),K=a(127),H=a(503),U=Object(f.a)((function(e){var t;return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:(t={flexGrow:1,display:"none"},Object(W.a)(t,e.breakpoints.up("sm"),{display:"block"}),Object(W.a)(t,"width",500),t)}})),Z=Object(K.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#ff9100"}}});function $(){var e=U();return l.a.createElement(H.a,{theme:Z},l.a.createElement("div",{className:e.root},l.a.createElement(V.a,{position:"static"},l.a.createElement(J.a,{variant:"dense"},l.a.createElement(E.a,{variant:"h6",className:e.title},"AAPICO STAFF LOCATION")))))}a(477);var q=Object(f.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));var Q=function(){var e=q(),t=l.a.useState(null),a=Object(c.a)(t,2),n=a[0],r=a[1],o=l.a.useState(null),i=Object(c.a)(o,2),s=i[0],u=i[1];return l.a.createElement(m.Provider,{value:{data:n,selectedID:s,getData:function(e){r(e)},getSelectedID:function(e){u(e)}}},l.a.createElement("div",{className:e.root},l.a.createElement(g.a,{container:!0,spacing:1},l.a.createElement($,null),l.a.createElement(g.a,{item:!0,xs:12},l.a.createElement(O,null)),l.a.createElement(g.a,{item:!0,xs:12},l.a.createElement(T,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[377,1,2]]]);
//# sourceMappingURL=main.d28683b1.chunk.js.map