(this["webpackJsonpstaff-location-dashboard"]=this["webpackJsonpstaff-location-dashboard"]||[]).push([[0],{379:function(e,t,a){e.exports=a(479)},384:function(e,t,a){},478:function(e,t,a){},479:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(16),o=a.n(l),c=(a(384),a(37)),i=a(108),s=a(225),u=a(74),m=a(372),d=(a(386),Object(n.createContext)({data:null,getData:function(){},selectId:null,getSelectedID:function(){}}));function p(){var e=Object(n.useContext)(d);return{data:e.data,getData:e.getData}}function f(){var e=Object(n.useContext)(d);return{selectedID:e.selectedID,getSelectedID:e.getSelectedID}}var g=a(322),h=a(502),E=a(58),v=a(501),b=a(508),y=a(59),x="https://backend.powermap.live",w="".concat(x,"/company-departments?_limit=-1"),O=Object(E.a)((function(e){return{root:{flexGrow:1}}}));function S(e){var t=O();return r.a.createElement(v.a,{container:!0,alignItems:"flex-start",className:t.root,spacing:2},r.a.createElement(v.a,{item:!0,xs:3,style:{margin:"auto"}},r.a.createElement(b.a,{src:x+e.info.avatar.url,alt:"props.info.firstName"})),r.a.createElement(v.a,{item:!0,xs:9},r.a.createElement(y.a,{component:"subtitle1",variant:"subtitle1"},e.info.firstName+" "+e.info.lastName,r.a.createElement("br",null),r.a.createElement("small",null,new Date(e.info.createdAt).toLocaleString()))),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(y.a,{component:"p",variant:"p"},e.info.address)))}var j={version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://mt0.google.com/vt/lyrs=y&hl=th&x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:22}]},k={width:"20px",height:"20px",color:"#fff",background:"#1978c8",borderRadius:"20px",textAlign:"center"},A={position:"absolute",top:65,left:0,padding:"10px",color:"white"},D=function(e){var t=e.longitude,a=e.latitude,n=e.pointCount;return r.a.createElement(u.e,{longitude:t,latitude:a},r.a.createElement("div",{style:Object(s.a)({},k,{background:"#f28a25"})},n))};function C(){var e=r.a.useState({longitude:100.594699,latitude:14.244686,bearing:0,zoom:8}),t=Object(c.a)(e,2),a=t[0],l=t[1],o=r.a.useState(null),d=Object(c.a)(o,2),E=d[0],v=d[1],b=r.a.useState({map:!0}),y=Object(c.a)(b,2),x=y[0],w=y[1],O=p().data,k=f(),C=k.selectedID,L=k.getSelectedID;Object(n.useEffect)((function(){C&&C.latitude&&(l(Object(s.a)({},a,{latitude:C.latitude,longitude:C.longitude,zoom:14})),v(C),L(null))}));return O?r.a.createElement(r.a.Fragment,null,r.a.createElement(u.h,Object.assign({style:{width:"100%",height:"400px"},mapStyle:x.map?"https://search.map.powermap.in.th/api/v2/map/vtile/styles?name=thailand_th_black&access_token=b378c575291af30a29f59919fd7e7e4c012d45c4":j},a,{onViewportChange:function(e){l(e)},dragPan:!0,viewportChangeMethod:"flyTo",viewportChangeOptions:1200,attributionControl:!1}),r.a.createElement(u.a,{compact:!1,position:"bottom-right",customAttribution:"Powered by Powermap"}),E&&r.a.createElement(u.g,{tipSize:5,anchor:"bottom",longitude:E.longitude,latitude:E.latitude,closeOnClick:!0,onClose:function(){return v(null)},style:{width:"300px !important"}},r.a.createElement(S,{info:E})),r.a.createElement(m.a,{radius:40,extent:512,nodeSize:64,component:D},O.map((function(e){return r.a.createElement(u.e,{key:e.id,longitude:e.longitude,latitude:e.latitude},r.a.createElement("svg",{height:20,viewBox:"0 0 24 24",style:{cursor:"pointer",fill:"#d00",stroke:"none",transform:"translate(0px,".concat(20,"px)")},onClick:function(){return t=e,console.log(t),void v(t);var t}},r.a.createElement("path",{d:"M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3\n  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9\n  C20.1,15.8,20.2,15.8,20.2,15.7z"})))}))),r.a.createElement(u.f,{showCompass:!0,showZoom:!0,position:"top-right"}),r.a.createElement(u.b,{position:"top-right"}),r.a.createElement(u.c,{position:"top-right",fitBoundsOptions:{maxZoom:14}})),r.a.createElement("div",{style:A},r.a.createElement(g.a,{control:r.a.createElement(h.a,{checked:x.map,onChange:function(e){w(Object(s.a)({},x,Object(i.a)({},e.target.name,e.target.checked)))},name:"map"}),label:x.map?"MAP":"Satellite"}))):null}var L=a(114),I=a.n(L),z=a(226),N=a(363),_=a.n(N),B=a(157),P=a(262),M=a(263),Y=a(266),W=a(327),F=a(113),G=a(362),R=a(97),T=a.n(R),V=a(370),J=a(22),K=a(254),Z=a(371),q=a.n(Z);function H(e){var t=r.a.useState(new T.a),a=Object(c.a)(t,2),l=a[0],o=a[1],i=r.a.useState(new T.a),s=Object(c.a)(i,2),u=s[0],m=s[1],d=r.a.useState(null),g=Object(c.a)(d,2),h=g[0],E=g[1],y=r.a.useState(),O=Object(c.a)(y,2),S=O[0],j=O[1],k=r.a.useState(),A=Object(c.a)(k,2),D=A[0],C=A[1],L=r.a.useState(null),N=Object(c.a)(L,2),R=N[0],Z=N[1],H=r.a.useState(null),U=Object(c.a)(H,2),$=U[0],Q=U[1],X=p().getData,ee=f().getSelectedID;Object(n.useEffect)((function(){function e(){return(e=Object(z.a)(I.a.mark((function e(){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(x+"/staff-locations?_limit=-1&_sort=createdAt:DESC&createdAt_gte=".concat((new T.a).startOf("day").add(7,"hours").toISOString())).then((function(e){return e.json()}));case 3:t=e.sent,console.log(t),E(t),X(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function t(){return(t=Object(z.a)(I.a.mark((function e(){var t,a,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(w).then((function(e){return e.json()}));case 3:return t=e.sent,a=[],n={},e.next=8,t.map((function(e,t){a.includes(e.companyName)||a.push(e.companyName),Object.keys(n).includes(e.companyName)?(console.log(e.companyName),n[e.companyName].push(e.department),console.log(n)):(console.log(e.companyName),n[e.companyName]=[e.department])}));case 8:Z(a),Q(n),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}h||function(){e.apply(this,arguments)}(),R&&$||(console.log(),function(){t.apply(this,arguments)}())}),[S,D]);var te=function(){var e=Object(z.a)(I.a.mark((function e(){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(x,"/staff-locations?_limit=-1&_sort=createdAt:DESC&createdAt_gte=").concat(new T.a(l).startOf("day").add(7,"hours").toISOString(),"&createdAt_lte=").concat(new T.a(u).endOf("day").add(7,"hours").toISOString(),"&").concat(S&&"ALL"!==S?"company="+S:"","&").concat(D&&"ALL"!==D?"department="+D:"")).then((function(e){return e.json()}));case 3:t=e.sent,console.log(t),E(t),X(t),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();console.log(D);function ae(e,t){var a=document.createElement("a"),n=function(e,t){var a,n=[];return e.forEach((function(e){"url"!==e.field&&n.push(e.field)})),a="",a+=n.join(","),a+="\n",t.forEach((function(e){var t=0;n.forEach((function(n){t>0&&(a+=","),a+="createdAt"===n?new Date(e[n]).toLocaleString():e[n],t++})),a+="\n"})),console.log(a),a}(e,t);if(null!=n){var r="export_from_".concat(new Date(l).toLocaleDateString(),"_to_").concat(new Date(u).toLocaleDateString(),".csv");n.match(/^data:text\/csv/i)||(n="data:text/csv;charset=utf-8,".concat(n)),a.setAttribute("href",encodeURI(n)),a.setAttribute("download",r),a.click()}}return h&&R&&$?r.a.createElement(J.a,{utils:V.a},r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,r.a.createElement("div",{style:{backgroundColor:"#e8eaf5"}},r.a.createElement(v.a,{container:!0,spacing:1,style:{marginLeft:15},justify:"center",alignItems:"center"},r.a.createElement(v.a,{item:!0,xs:6,md:2},r.a.createElement(K.b,{margin:"normal",id:"date-picker-dialog",label:"start date",format:"YYYY/MM/DD",value:l,onChange:function(e){o(e)},KeyboardButtonProps:{"aria-label":"change date"},inputVariant:"outlined",size:"small"})),r.a.createElement(v.a,{item:!0,xs:6,md:2},r.a.createElement(K.b,{margin:"normal",id:"date-picker-dialog",label:"end date",format:"YYYY/MM/DD",value:u,onChange:function(e){m(e)},KeyboardButtonProps:{"aria-label":"change date"},inputVariant:"outlined",size:"small"})),r.a.createElement(v.a,{item:!0,xs:12,md:2},r.a.createElement("div",null,r.a.createElement(P.a,{variant:"outlined",fullWidth:!0,style:{maxWidth:266},size:"small"},r.a.createElement(M.a,{id:"demo-simple-select-outlined-label"},"Company"),r.a.createElement(Y.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:S||"ALL",onChange:function(e){j(e.target.value),C("ALL")},label:"Company"},r.a.createElement(W.a,{value:"ALL",key:"first"},"ALL"),R.map((function(e,t){return r.a.createElement(W.a,{value:e,key:t},e)})))))),r.a.createElement(v.a,{item:!0,xs:12,md:2},r.a.createElement(P.a,{variant:"outlined",fullWidth:!0,style:{maxWidth:266},size:"small"},r.a.createElement(M.a,null,"Department"),r.a.createElement(Y.a,{id:"demo-simple-select-outlined",value:D||"ALL",onChange:function(e){C(e.target.value)},label:"Department"},r.a.createElement(W.a,{value:"ALL",key:"first"},"ALL"),S?$[S].map((function(e,t){return r.a.createElement(W.a,{value:e,key:t},e)})):null))),r.a.createElement(F.a,{variant:"contained",color:"primary",size:"large",onClick:function(){return te()}},"SEARCH")))),r.a.createElement(_.a,{onRowClick:function(e,t){console.log(t),ee(t)},title:"".concat(q.a.uniqBy(h,"empID").length," persons"),columns:[{title:"Company",field:"company"},{title:"Department",field:"department"},{field:"url",title:"Avatar",width:30,export:!1,grouping:!1,render:function(e){return r.a.createElement(b.a,{alt:"selfie",src:x+e.avatar.formats.small.url,style:{width:30,height:30}})}},{title:"Emp. ID",field:"empID"},{title:"First name",field:"firstName",grouping:!1},{title:"Last name",field:"lastName",grouping:!1},{title:"Gender",field:"gender",hidden:!0,export:!0,grouping:!1},{title:"Email",field:"email",hidden:!0,export:!0,grouping:!1},{title:"Address",field:"address",hidden:!0,export:!0,grouping:!1},{title:"Checkin At",field:"createdAt",grouping:!1,render:function(e){return new Date(e.createdAt).toLocaleString()}}],detailPanel:function(e){return r.a.createElement(v.a,{container:!0,spacing:2,style:{margin:10}},r.a.createElement(v.a,{item:!0},r.a.createElement(b.a,{alt:"selfie",src:x+e.avatar.formats.small.url,style:{width:150,height:150}})),r.a.createElement(v.a,{item:!0},r.a.createElement(G.a,{label:e.gender})),r.a.createElement(v.a,{item:!0},r.a.createElement(G.a,{label:e.email})),r.a.createElement(v.a,{item:!0},r.a.createElement(G.a,{label:e.address})))},options:{search:!0,exportButton:!0,paging:!0,pageSize:20,grouping:!0,exportAllData:!0,exportCsv:function(e,t){ae(e,t)},pageSizeOptions:[5,10,20,50],cellStyle:{height:40,paddingTop:0,paddingBottom:0,textAlign:"right"},headerStyle:{textAlign:"right"}},data:h}))):null}var U=a(506),$=a(261),Q=a(128),X=a(505),ee=Object(E.a)((function(e){var t;return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:(t={flexGrow:1,display:"none"},Object(i.a)(t,e.breakpoints.up("sm"),{display:"block"}),Object(i.a)(t,"width",500),t)}})),te=Object(Q.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#ff9100"}}});function ae(){var e=ee();return r.a.createElement(X.a,{theme:te},r.a.createElement("div",{className:e.root},r.a.createElement(U.a,{position:"static"},r.a.createElement($.a,{variant:"dense"},r.a.createElement(y.a,{variant:"h6",className:e.title},"AAPICO STAFF LOCATION")))))}a(478);var ne=Object(E.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));var re=function(){var e=ne(),t=r.a.useState(null),a=Object(c.a)(t,2),n=a[0],l=a[1],o=r.a.useState(null),i=Object(c.a)(o,2),s=i[0],u=i[1];return r.a.createElement(d.Provider,{value:{data:n,selectedID:s,getData:function(e){l(e)},getSelectedID:function(e){u(e)}}},r.a.createElement("div",{className:e.root},r.a.createElement(v.a,{container:!0,spacing:1},r.a.createElement(ae,null),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(C,null)),r.a.createElement(v.a,{item:!0,xs:12},r.a.createElement(H,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(re,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[379,1,2]]]);
//# sourceMappingURL=main.c8a656a6.chunk.js.map