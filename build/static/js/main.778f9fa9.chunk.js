(this["webpackJsonpstaff-location-dashboard"]=this["webpackJsonpstaff-location-dashboard"]||[]).push([[0],{385:function(e,t,a){e.exports=a(502)},390:function(e,t,a){},402:function(e,t){},501:function(e,t,a){},502:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(16),c=a.n(l),o=(a(390),a(31)),i=a(93),s=a(226),u=a(74),m=a(378),d=(a(392),Object(n.createContext)({data:null,getData:function(){},selectId:null,getSelectedID:function(){},heatMap:null,getSelectedHeatMap:function(){}}));function p(){var e=Object(n.useContext)(d);return{data:e.data,getData:e.getData}}function f(){var e=Object(n.useContext)(d);return{selectedID:e.selectedID,getSelectedID:e.getSelectedID,heatMap:e.heatMap,getSelectedHeatMap:e.getSelectedHeatMap}}var h=a(329),g=a(525),E=a(524),v=a(328),b=a(58),y=a(531),x=a(366),S=a(59),w="https://backend.powermap.live",O="".concat(w,"/company-departments?_limit=-1"),j=Object(b.a)((function(e){return{root:{flexGrow:1}}}));function k(e){var t=j(),a=e.info.avatar.formats?e.info.avatar.formats.thumbnail.url:e.info.avatar.url;return r.a.createElement(E.a,{container:!0,alignItems:"flex-start",className:t.root,spacing:2},r.a.createElement(E.a,{item:!0,xs:3,style:{margin:"auto"}},r.a.createElement(y.a,{src:w+a,alt:e.info.firstName})),r.a.createElement(E.a,{item:!0,xs:9},r.a.createElement(S.a,{component:"subtitle1",variant:"subtitle1"},e.info.firstName+" "+e.info.lastName,r.a.createElement("br",null),r.a.createElement("small",null,new Date(e.info.createdAt).toLocaleString()))),r.a.createElement(E.a,{item:!0,xs:12},r.a.createElement("div",{style:{flex:"right"}},r.a.createElement(x.a,{label:e.info.healthStatus})),r.a.createElement(S.a,{component:"p",variant:"p"},e.info.address)))}var D={version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://mt0.google.com/vt/lyrs=y&hl=th&x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:22}]},A=a(396),C=(a(252),{width:"20px",height:"20px",color:"#fff",background:"#1978c8",borderRadius:"20px",textAlign:"center"}),L={position:"absolute",top:45,left:0,padding:"10px",color:"white"},I=function(e){var t=e.longitude,a=e.latitude,n=e.pointCount;return r.a.createElement(u.e,{longitude:t,latitude:a},r.a.createElement("div",{style:Object(s.a)({},C,{background:"#f28a25"})},n))};function M(){var e=Object(n.useRef)(null),t=r.a.useState({longitude:100.594699,latitude:14.244686,bearing:0,zoom:8}),a=Object(o.a)(t,2),l=a[0],c=a[1],d=r.a.useState(null),b=Object(o.a)(d,2),y=b[0],x=b[1],S=r.a.useState({map:!0}),w=Object(o.a)(S,2),O=w[0],j=w[1],C=p().data,M=f(),z=M.selectedID,_=M.getSelectedID,N=M.heatMap;Object(n.useEffect)((function(){z&&z.latitude&&(c(Object(s.a)({},l,{latitude:z.latitude,longitude:z.longitude,zoom:14})),x(z),_(null))}));return C?r.a.createElement("div",null,r.a.createElement(u.h,Object.assign({ref:function(t){return e.current=t&&t.getMap()},onLoad:function(){return console.log("mapRef.current is ready for use",e.current)},style:{width:"100%",height:"calc(100vh - 48px)"},mapStyle:O.map?"https://search.map.powermap.in.th/api/v2/map/vtile/styles?name=thailand_th_black&access_token=b378c575291af30a29f59919fd7e7e4c012d45c4":D},l,{onViewportChange:function(e){c(e)},dragPan:!0,viewportChangeMethod:"flyTo",viewportChangeOptions:1200,attributionControl:!1}),N?r.a.createElement(A,Object.assign({locations:C},l,{width:e.current?e.current._canvas.clientWidth:0,height:e.current?e.current._canvas.clientHeight:0})):r.a.createElement(m.a,{radius:40,extent:512,nodeSize:64,component:I},C.map((function(e){return r.a.createElement(u.e,{key:e.id,longitude:e.longitude,latitude:e.latitude},r.a.createElement("svg",{height:25,viewBox:"0 0 24 24",style:{cursor:"pointer",fill:"#d00",stroke:"none",transform:"translate(0px,".concat(25,"px)")},onClick:function(){x(e)}},r.a.createElement("path",{d:"M20.2,15.7L20.2,15.7c1.1-1.6,1.8-3.6,1.8-5.7c0-5.6-4.5-10-10-10S2,4.5,2,10c0,2,0.6,3.9,1.6,5.4c0,0.1,0.1,0.2,0.2,0.3\n  c0,0,0.1,0.1,0.1,0.2c0.2,0.3,0.4,0.6,0.7,0.9c2.6,3.1,7.4,7.6,7.4,7.6s4.8-4.5,7.4-7.5c0.2-0.3,0.5-0.6,0.7-0.9\n  C20.1,15.8,20.2,15.8,20.2,15.7z"})))}))),r.a.createElement(u.a,{compact:!1,position:"bottom-right",customAttribution:"Powered by Powermap"}),y&&r.a.createElement(u.g,{tipSize:5,anchor:"bottom",longitude:y.longitude,latitude:y.latitude,closeOnClick:!0,onClose:function(){return x(null)},style:{width:"300px !important"}},r.a.createElement(k,{info:y})),r.a.createElement(u.f,{showCompass:!0,showZoom:!0,position:"top-right"}),r.a.createElement(u.b,{position:"top-right"}),r.a.createElement(u.c,{position:"top-right",fitBoundsOptions:{maxZoom:14}})),r.a.createElement("div",{style:L},r.a.createElement(h.a,{control:r.a.createElement(g.a,{checked:O.map,onChange:function(e){j(Object(s.a)({},O,Object(i.a)({},e.target.name,e.target.checked)))},name:"map"}),label:O.map?"MAP":"Satellite"}))):r.a.createElement(E.a,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(v.a,null))}var z=a(115),_=a.n(z),N=a(227),W=a(369),H=a.n(W),Y=a(159),B=a(266),P=a(267),R=a(270),G=a(333),V=a(114),J=a(98),K=a.n(J),T=a(376),Z=a(21),q=a(259),F=a(377),U=a.n(F);function X(e){var t=r.a.useState(new K.a),a=Object(o.a)(t,2),l=a[0],c=a[1],s=r.a.useState(new K.a),u=Object(o.a)(s,2),m=u[0],d=u[1],h=r.a.useState(null),g=Object(o.a)(h,2),b=g[0],S=g[1],j=r.a.useState(),k=Object(o.a)(j,2),D=k[0],A=k[1],C=r.a.useState(),L=Object(o.a)(C,2),I=L[0],M=L[1],z=r.a.useState(null),W=Object(o.a)(z,2),J=W[0],F=W[1],X=r.a.useState(null),$=Object(o.a)(X,2),Q=$[0],ee=$[1],te=p().getData,ae=f().getSelectedID;Object(n.useEffect)((function(){function e(){return(e=Object(N.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(w+"/staff-locations?_limit=-1&_sort=createdAt:DESC&createdAt_gte=".concat((new K.a).startOf("day").toISOString())).then((function(e){return e.json()}));case 3:t=e.sent,S(t),te(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function t(){return(t=Object(N.a)(_.a.mark((function e(){var t,a,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(O).then((function(e){return e.json()}));case 3:return t=e.sent,a=[],n={},e.next=8,t.map((function(e,t){a.includes(e.companyName)||a.push(e.companyName),Object.keys(n).includes(e.companyName)?n[e.companyName].push(e.department):n[e.companyName]=[e.department]}));case 8:F(a),ee(n),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}b||function(){e.apply(this,arguments)}(),J&&Q||function(){t.apply(this,arguments)}()}),[D,I]);var ne=function(){var e=Object(N.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(w,"/staff-locations?_limit=-1&_sort=createdAt:DESC&createdAt_gte=").concat(new K.a(l).startOf("day").toISOString(),"&createdAt_lte=").concat(new K.a(m).endOf("day").toISOString(),"&").concat(D&&"ALL"!==D?"company="+D:"","&").concat(I&&"ALL"!==I?"department="+I.replace("&","%26"):"")).then((function(e){return e.json()}));case 3:t=e.sent,S(t),te(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();function re(e,t){var a=document.createElement("a"),n=function(e,t){var a,n=[];return e.forEach((function(e){"url"!==e.field&&n.push(e.field)})),a="",a+=n.join(","),a+="\n",t.forEach((function(e){var t=0;n.forEach((function(n){t>0&&(a+=","),a+="createdAt"===n?new Date(e[n]).toLocaleString():e[n],t++})),a+="\n"})),a}(e,t);if(null!=n){var r="export_from_".concat(new Date(l).toLocaleDateString(),"_to_").concat(new Date(m).toLocaleDateString(),".csv");n.match(/^data:text\/csv/i)||(n="data:text/csv;charset=utf-8,".concat(n)),a.setAttribute("href",encodeURI(n)),a.setAttribute("download",r),a.click()}}return b&&J&&Q?r.a.createElement(Z.a,{utils:T.a},r.a.createElement("div",{style:{height:"calc(100vh - 48px)",overflowY:"scroll"}},r.a.createElement(Y.a,{style:{overflow:"hidden"}},r.a.createElement("div",{style:{backgroundColor:"#e8eaf5"}},r.a.createElement(E.a,{container:!0,spacing:1,justify:"center",alignItems:"center"},r.a.createElement(E.a,{item:!0,xs:6,md:3,style:{height:80}},r.a.createElement(q.b,{margin:"normal",id:"date-picker-dialog",label:"start date",format:"YYYY/MM/DD",value:l,onChange:function(e){c(e)},KeyboardButtonProps:{"aria-label":"change date"},inputVariant:"outlined",size:"small"})),r.a.createElement(E.a,{item:!0,xs:6,md:3,style:{height:80}},r.a.createElement(q.b,{margin:"normal",id:"date-picker-dialog",label:"end date",format:"YYYY/MM/DD",value:m,onChange:function(e){d(e)},KeyboardButtonProps:{"aria-label":"change date"},inputVariant:"outlined",size:"small"})),r.a.createElement(E.a,{item:!0,xs:12,md:2},r.a.createElement("div",null,r.a.createElement(B.a,{variant:"outlined",fullWidth:!0,style:{maxWidth:266},size:"small"},r.a.createElement(P.a,{id:"demo-simple-select-outlined-label"},"Company"),r.a.createElement(R.a,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",value:D||"ALL",onChange:function(e){A(e.target.value),M("ALL")},label:"Company"},r.a.createElement(G.a,{value:"ALL",key:"first"},"ALL"),J.map((function(e,t){return r.a.createElement(G.a,{value:e,key:t},e)})))))),r.a.createElement(E.a,{item:!0,xs:12,md:2},r.a.createElement(B.a,{variant:"outlined",fullWidth:!0,style:{maxWidth:266},size:"small"},r.a.createElement(P.a,null,"Department"),r.a.createElement(R.a,{id:"demo-simple-select-outlined",value:I||"ALL",onChange:function(e){M(e.target.value)},label:"Department"},r.a.createElement(G.a,{value:"ALL",key:"first"},"ALL"),D?Q[D].map((function(e,t){return r.a.createElement(G.a,{value:e,key:t},e)})):null))),r.a.createElement(V.a,Object(i.a)({variant:"contained",color:"primary",size:"large",onClick:function(){return ne()}},"size","small"),"SEARCH"))),r.a.createElement(H.a,{onRowClick:function(e,t){ae(t)},title:"".concat(U.a.uniqBy(b,"empID").length," persons"),columns:[{title:"Company",field:"company"},{title:"Department",field:"department",width:50},{field:"url",title:"Avatar",export:!1,headerStyle:{maxWidth:60},cellStyle:{padding:"0px"},grouping:!1,render:function(e){var t=e.avatar.formats?e.avatar.formats.thumbnail.url:e.avatar.url;return r.a.createElement(y.a,{alt:e.firstName,src:w+t,style:{width:30,height:30}})}},{title:"E. ID",field:"empID"},{title:"F. name",field:"firstName",headerStyle:{maxWidth:60},grouping:!1},{title:"L. name",field:"lastName",headerStyle:{maxWidth:40},grouping:!1},{title:"Health",field:"healthStatus",headerStyle:{maxWidth:60},grouping:!1},{title:"Gender",field:"gender",hidden:!0,export:!0,grouping:!1},{title:"Email",field:"email",hidden:!0,export:!0,grouping:!1},{title:"Address",field:"address",hidden:!0,export:!0,grouping:!1},{title:"At",field:"createdAt",grouping:!1,headerStyle:{minWidth:120},width:120,render:function(e){return new Date(e.createdAt).toLocaleString()}}],detailPanel:function(e){return r.a.createElement(E.a,{container:!0,spacing:2,style:{margin:10}},r.a.createElement(E.a,{item:!0},r.a.createElement(y.a,{alt:e.firstName,src:w+e.avatar.url,style:{width:150,height:150}})),r.a.createElement(E.a,{item:!0},r.a.createElement(x.a,{label:e.gender})),r.a.createElement(E.a,{item:!0},r.a.createElement(x.a,{label:e.email})),r.a.createElement(E.a,{item:!0},r.a.createElement(x.a,{label:e.address})))},options:{search:!0,exportButton:!0,paging:!0,pageSize:20,grouping:!0,exportAllData:!0,exportCsv:function(e,t){re(e,t)},pageSizeOptions:[5,10,20,50,100,500],cellStyle:{height:30,paddingTop:0,paddingBottom:0}},data:b})))):r.a.createElement(E.a,{container:!0,justify:"center",alignItems:"center",style:{minHeight:"100vh",maxWidth:"100%"}},r.a.createElement(v.a,null))}var $=a(529),Q=a(265),ee=a(364),te=a(130),ae=a(528),ne=Object(b.a)((function(e){var t;return{root:{flexGrow:1},title:(t={flexGrow:1,display:"none"},Object(i.a)(t,e.breakpoints.up("sm"),{display:"block"}),Object(i.a)(t,"width",500),t)}})),re=Object(te.a)({palette:{primary:{main:"#1976d2"},secondary:{main:"#ff9100"}}});function le(){var e=f().getSelectedHeatMap,t=Object(n.useState)(!1),a=Object(o.a)(t,2),l=a[0],c=a[1],i=ne();return r.a.createElement(ae.a,{theme:re},r.a.createElement("div",{className:i.root},r.a.createElement($.a,{position:"static"},r.a.createElement(Q.a,{variant:"dense"},r.a.createElement(S.a,{className:i.title},r.a.createElement("img",{src:"/dashboard/Logo4.png",height:"50",alt:"logo"})),r.a.createElement(h.a,{control:r.a.createElement(ee.a,{checked:l,onChange:function(t){c(t.target.checked),e(t.target.checked)},name:"heatMap",color:"secondary"}),label:"Heat Map"})))))}a(501);var ce=Object(b.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}}));var oe=function(){var e=ce(),t=r.a.useState(null),a=Object(o.a)(t,2),n=a[0],l=a[1],c=r.a.useState(null),i=Object(o.a)(c,2),s=i[0],u=i[1],m=r.a.useState(!1),p=Object(o.a)(m,2),f=p[0],h=p[1];return r.a.createElement(d.Provider,{value:{data:n,selectedID:s,getData:function(e){l(e)},getSelectedID:function(e){u(e)},heatMap:f,getSelectedHeatMap:function(e){h(e)}}},r.a.createElement("div",{className:e.root},r.a.createElement(le,null),r.a.createElement(E.a,{container:!0},r.a.createElement(E.a,{item:!0,xs:12,xl:6,lg:4},r.a.createElement(M,null)),r.a.createElement(E.a,{item:!0,xs:12,xl:6,lg:8},r.a.createElement("div",{style:{height:"100%",overflowY:"scroll",overflowX:"scroll"}},r.a.createElement(X,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[385,1,2]]]);
//# sourceMappingURL=main.778f9fa9.chunk.js.map